import { useState, useRef, useEffect } from "react";
import { jsPDF } from "jspdf";
import emailjs from "@emailjs/browser";

const compassB64 = "data:image/png;base64,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";
const deligoB64 = "data:image/png;base64,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";
const autocanteenB64 = "data:image/png;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/4gHYSUNDX1BST0ZJTEUAAQEAAAHIAAAAAAQwAABtbnRyUkdCIFhZWiAH4AABAAEAAAAAAABhY3NwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAA9tYAAQAAAADTLQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAlkZXNjAAAA8AAAACRyWFlaAAABFAAAABRnWFlaAAABKAAAABRiWFlaAAABPAAAABR3dHB0AAABUAAAABRyVFJDAAABZAAAAChnVFJDAAABZAAAAChiVFJDAAABZAAAAChjcHJ0AAABjAAAADxtbHVjAAAAAAAAAAEAAAAMZW5VUwAAAAgAAAAcAHMAUgBHAEJYWVogAAAAAAAAb6IAADj1AAADkFhZWiAAAAAAAABimQAAt4UAABjaWFlaIAAAAAAAACSgAAAPhAAAts9YWVogAAAAAAAA9tYAAQAAAADTLXBhcmEAAAAAAAQAAAACZmYAAPKnAAANWQAAE9AAAApbAAAAAAAAAABtbHVjAAAAAAAAAAEAAAAMZW5VUwAAACAAAAAcAEcAbwBvAGcAbABlACAASQBuAGMALgAgADIAMAAxADb/2wBDAAUDBAQEAwUEBAQFBQUGBwwIBwcHBw8LCwkMEQ8SEhEPERETFhwXExQaFRERGCEYGh0dHx8fExciJCIeJBweHx7/2wBDAQUFBQcGBw4ICA4eFBEUHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh7/wAARCAA5AK0DASIAAhEBAxEB/8QAHAAAAgMBAQEBAAAAAAAAAAAAAAYCBQcEAQMI/8QAQhAAAAUCAgUJBQQIBwAAAAAAAQIDBAUABgcREhchVpQTFjFBU1WR0dIUIlFhcQgyN4E1QnJ1dqGxshUjUmKCweH/xAAZAQEAAwEBAAAAAAAAAAAAAAAAAQIDBQT/xAAxEQABAwIDBQgBBAMAAAAAAAABAAIRAwQSITEFE1FxkRQiMkFSU2HRgSMzobE0Q/H/2gAMAwEAAhEDEQA/AP2XRRS9OXvaEG8FnL3JGM3IdKSjgoGD6h0hUFwbmStKdJ9U4WNJPxmmGik/Wjh5vjEcQFGtHDzfGI4gKpvWeoLfsF17Tuh+k4UUn60cPN8YjiAo1o4eb4xHEBTes9QTsF17Tuh+k4UUn60cPN8YjiAo1o4eb4xHEBTes9QTsF17Tuh+k4UUn60cPN8YjiAo1o4eb4xHEBTes9QTsF17Tuh+k4UUn60cPN8YjiAo1o4eb4xHEBTes9QTsF17Tuh+k4UUn60cPN8YjiAo1o4eb4xHEBTes9QTsF17Tuh+k4UUn60cPN8YjiAo1o4eb4xHEBTes9QTsF17Tuh+k4UUn60cPN8YjiAo1o4eb4xHEBTes9QTsF17Tuh+k4UUn60cPN8YjiAqbfEuwF1yIpXfDmUOORQ9pKGY/Uab1nEIbC6H+t3QptorxM5FCFUTMU5DAAlMUcwEB6wr2tF5FT3u/Xi7NmZFqbRcNmKyqRsugwEEQHxpLwYs23T4fRcq/iWchJSSAO3bp0iVVRU5/e2ibP45U04n/hzcX7tX/sGubBz8K7Z/dqP9oVgQDVE8F1ab3U9nuLDBLxMcirPmna27cPwSflRzTtbduH4JPyrJ8Tbku19dc26tOSXSjrPRRVdIoDmV4qJwMoQ37JAHMPkPxq3xxux1qhjrktqScM/bXTcxFUD6JtA4GESiIeAh8qoarBiy0/lehuz7pzqTd54zGp7pIBE8wQf+LQeadrbtw/BJ+VHNO1t24fgk/KlP7QstJw2Frl/Evl2Tsq6BQWRPomABOACGfzpXxlaXBD2YpeUdes+gqp7KAMyLACJdMCFNlsz+I/UampUaye7oJVLS0rXDaZNXDjcWjXURw5rVOadrbtw/BJ+VHNO1t24fgk/Ks5u1zMYa2K5lkbnlpySkxQasiSJynIiqbMdIAy+GfT8AqcnYl6x1urzTfEmdWnG7cy4pqCUWyhilzEnJ5ZAGzLOheJgMz/Cltq4gOdcQ0mAe9mRE8gJ1Wh807W3bh+CT8qOadrbtw/BJ+VZVJYl3BcFk2e1gBTj5y5XB2yi+WYN+SMAKHKA7NuYD8gH402w9g3FFSrJ+jiNPOwIqBniD3RVScE6ygX9TP5dFS2o1x7rZ6KKtpWoNmvWwnOBmZgwdNMxATRzTtbduH4JPyo5p2tu3D8En5VnmMcrdEvdTSzLKk1mbxuyWkXyjc2RwAC5JJjl/qHq/3BVvE3c4uHAx1caKpm8inGrlWEg5GScJlEDD8hzDP8wpvGYi2NFU2l0KNOrvPEQIkyJmCecGE2c07W3bh+CT8qOadrbtw/BJ+VZNhDiRLvLeXt261FUZc0ad3FvFRyM9SEhhAQHrMGXT1gA9YDVhajCduvB6DnlbznWLxBk4OqdssGbgwHNkJxENuQFAPpVW1mPAwhbVtnXNu5wrVYAIE5kGQSCI8soWk807W3bh+CT8qOadrbtw/BJ+VZjgSynpy1WF5Sd5zzlTSXAzJRYBQPoiYgZhln8B6ekKSrAuRnKQh3F1Yuz8TIA5OQG6a4iGgGWiP3R6dvX1VXfthpLdeS1Gy65fUa2sTuyAYDjmZ8hy1X6D5p2tu3D8En5Uc07W3bh+CT8qyjGOUewM1Y0SN5SsdGLpKkfPyK5KKFKBMlDZBtHb8Our6wVYtZOYfwmI8zcotmJynRcqZkSEQzKcPdD3vdHL86uKrS8tj+uawdZV227a+8MHTJ3GMzoE8807W3bh+CT8q+Tuy7RdtVGy9sxBklC6JgBoQBEPqAZhWP8A2fsTZZQzSCvJddUsmJzxci4NnypgHRMkJvqA5fPZ1hTl9nCYlZuwnLuYfuHzgsmumCi59IwFAC5Bn8AzqKdWnViBqpvdn3lkXl7/AAEZgnOZzHKDPyvPs+LuUoift9VwddtCTCzNmJxETFRDIQLn8sxrTay/Ab9I33/Ea39ArUK0t/2wvJtf/MeeMHqASlzE/wDDm4v3av8A2DVZhkZ6TBeDNGpkVehDkFuQ5tEplND3QEeoM8qZbmjAmbckogVOS9saqIAfLPRExRDP8s6yyx8Q2NjW81tC+WT6KkIogNyqg3Moi5IH3TkMUB6sqq9wZUl2Qha2tN9ezNOkMTg4GPOII08/mF7Z2C4FgjK3HOzSMu/OdWRKxfCRI5jGHpAA97YPSPxr5MsK5xfDOXsKRdJJoNn4uYR4B9LMuYiBVCgHu9ef7Xypg13Yd96ueCV9NGu7DvvVzwSvprINtgIkdV0HV9tOcSabtQR3TkRpH9clQT9uYpX1GMrYudpDRcYmsmo8et1xUO4AnRok6s+nbl/1TdjLa0jcuHKtvwZEhccqgKZVVNEuiQ4CO36BXBruw771c8Er6aNd2HfernglfTVpowQXTPysi3aeOm5lAtDDIAaYnLPj5Dz5K+xBs9G8LHPAOF/ZlwBM6C4BpckqToNl19YfQaTnbfGqRgz2y5aW8gCyXs60wVwIiKYhkJgTy+8IfLwqz13Yd96ueCV9NGu7DvvVzwSvpqXOouM44/KpQo7RpMwG3LgDIlpMH46DIyPhcs7hRydkwEbbMl7HMW6py7F0qHuqKCOZ9PpyAw7evLo2hXdCucXnsqwRlYyAi2KCgGerprCsZyUA2gQv6ufzHZ/Kvnruw771c8Er6aNd2HfernglfTUTRBlro/KsWbTewtq0C7WCWmROsfnPOc1UwmFb+Wmpq5brlJKNlJB2YU04p+JCkbgAAQomANo7P5VKBw8nLcQvO34w/tUHLsxMwUcOAFUrgSCUwH2dAiP3vkFWmu7DvvVzwSvpo13Yd96ueCV9NQBbjMOHVaOqbYcC00nYcssJgRERyhcEvhYadwkg4J4dNncEQzIVu5TNmBFALkJBMHSQf/aY8Orck4PCVpbb8iRZBJoskYpD6RdIxjiG3/kFVeu7DvvVzwSvpo13Yd96ueCV9NS00GuxBwmI1WVVm1qtLdPpOLcWLwnI56fGei78GLYlbWwzbQEsREr1MywmBNTSL7xzCG36DSTh5beJlmwJ4hC1rckCGcnXBVw9yN72WzYX5Uz67sO+9XPBK+mjXdh33q54JX01H6MNh8R8hXA2liqF1uTvDJlrtc9II4lV2Ids3tOTVmXGziYpR9EkUUdtFHWSQKG0fdActobB20wQHPp37c0m7agoxss0UKRRm6E5jKCGRQEMg2bR21wa7sO+9XPBK+mjXdh33q54JX01IdSDpx/yFR1LaDqQpm2OWhwukZk8eJVVbWFCjrBdvZ9yFRbybdZVZs5RNpi3UE4iUwDs6hyEKvsB7Tl7NspWImgQ9pF8qsApKaZRKYCgA5/kNc2u7DvvVzwSvpr5ucbrIBA/+HqSMk6y/wApqgyU01TdQBmGVG9naQ4OEgRqrVxta4Y+k+k7C92LwnI/HAL54D/pG+/4jW/oFahSFgpb8rDwUjIziXs8hNyCkgq2zzFADZaJBH45Bt+tPtbUARTErm7Ve1928tMjIdAAivDFKb7xQH6hXtFarnqPJp9mXwo5NPsy+FSookqPJp9mXwo5NPsy+FSookqPJp9mXwo5NPsy+FSookqPJp9mXwo5NPsy+FSookqPJp9mXwo5NPsy+FSookqPJp9mXwo5NPsy+FSookqPJp9mXwo5NPsy+FSookqPJp9mXwo5NPsy+FSookqPJp9mXwoAhAHMCFAfkFSooiKKKKIv/9k=";
const visionB64 = "data:image/png;base64,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";


const fmt  = (n) => (+n).toLocaleString("en-GB",{style:"currency",currency:"GBP",minimumFractionDigits:2});
const fmtN = (n) => (+n).toLocaleString("en-GB",{minimumFractionDigits:2,maximumFractionDigits:2});

const SUPPLIERS = {
  VISION_CHECKOUT: { name:"Vision Checkout", color:"#1a56db", logo:visionB64 },
  AUTOCANTEEN:     { name:"AutoCanteen",     color:"#c81e1e", logo:autocanteenB64 },
  DELIGO:          { name:"Deligo",          color:"#057a55", logo:deligoB64 },
};

// ─── EmailJS configuration ───────────────────────────────────────────────────
// Sign up at https://www.emailjs.com, create a service & template, then paste
// your IDs below.  The template should expose these variables:
//   {{client_name}}, {{outlet_name}}, {{date_initial_request}}, {{go_live_date}},
//   {{unit_number}}, {{sector}}, {{sector_contact}}, {{status}},
//   {{ai_tray_autocanteen}}, {{ai_tray_vision_checkout}}, {{deligo_ai_scanners}}
const EMAILJS_SERVICE_ID  = "service_o7dma6d";
const EMAILJS_TEMPLATE_ID = "template_bklldas";
const EMAILJS_PUBLIC_KEY  = "xqcop60IMiHuzOz2y";

const SECTORS = ["Compass One","Chartwells","Compass Ireland","B&I","RA","Levy"];

function getSteps(supplier) {
  return supplier === "DELIGO"
    ? ["supplier","t2e","quantities","sme","siteinfo","summary"]
    : ["supplier","quantities","sme","siteinfo","summary"];
}

function calcQuote({ supplier, scanners, weighPays, smeDays, t2eExisting }) {
  const B = [];
  const add = (section, label, unitCost, qty) => {
    const cost = unitCost * qty;
    B.push({ section, label, unitCost, qty, cost });
    return cost;
  };
  let hw = 0, ins = 0, ann = 0;

  if (supplier === "VISION_CHECKOUT") {
    hw  += add("Hardware","AI Scanner & Base",3373,scanners);
    hw  += add("Hardware","Receipt Printer",190,scanners);
    hw  += add("Hardware","Worldpay Omni-Channel MID",50,1);
    if (weighPays>0) hw += add("Hardware","Weigh & Pay Scale",750,weighPays);
    ins += add("Installation","Site Survey, Config, Install & Training (1st Device)",1750,1);
    if (scanners>1) ins += add("Installation","Config & Install — Additional Scanner",1072.5,scanners-1);
    ann += add("Annual","Vision / Front End Software",4649.50,scanners);
    ann += add("Annual","EFT / TCPOS Cloud License (per Location)",1583,1);
    ann += add("Annual","Worldpay PED Rental & Support",116.52,scanners);
  }
  if (supplier === "AUTOCANTEEN") {
    hw  += add("Hardware","AI Scanner & Receipt Printer",4400,scanners);
    hw  += add("Hardware","Worldpay Omni-Channel MID",50,1);
    if (weighPays>0) hw += add("Hardware","Weigh & Pay Scale",660,weighPays);
    ins += add("Installation","Site Survey, Config, Install & Training (1st Device)",4576,1);
    if (scanners>1) ins += add("Installation","Config & Install — Additional Scanner",352,scanners-1);
    ins += add("Installation","Hardware Support with SLA",660,scanners);
    ann += add("Annual","Support & Software License — Scanner",5280,scanners);
    if (weighPays>0) ann += add("Annual","Support & Software License — Weigh & Pay",440,weighPays);
    ann += add("Annual","Worldpay PED Rental & Support",116.52,scanners);
  }
  if (supplier === "DELIGO") {
    hw  += add("Hardware","AI Scanner",3800,scanners);
    hw  += add("Hardware","Worldpay Omni-Channel MID",50,1);
    if (weighPays>0) hw += add("Hardware","Weigh & Pay Scale",695,weighPays);
    ins += add("Installation","Site Survey, Config, Install & Training",750,1);
    ins += add("Installation","UPS Shipping",100,scanners);
    ann += add("Annual","Deligo Licence Fee",4560,scanners);
    ann += add("Annual","POS T2E Licence",150,scanners);
    if (!t2eExisting) ann += add("Annual","Control Desk Fee",625,1);
    ann += add("Annual","Worldpay PED Rental & Support",116.52,scanners);
  }

  const impl = 1250 + smeDays * 300;
  B.push({ section:"Implementation", label:"Implementation Fee", unitCost:impl, qty:1, cost:impl });
  const cap = hw + ins + impl;
  const cont = (cap + ann) * 0.025;
  return { breakdown:B, hardwareCost:hw, installCost:ins, implementationTotal:impl, annualCost:ann, capitalCost:cap, contingency:cont, grandTotal:cap+ann+cont };
}

function hexRgb(hex) {
  return [parseInt(hex.slice(1,3),16), parseInt(hex.slice(3,5),16), parseInt(hex.slice(5,7),16)];
}

// ── PDF builders ─────────────────────────────────────────────────────────────
function makeSummaryPDF({ siteInfo, supplier, result, scanners, weighPays, t2eExisting }) {
  const doc = new jsPDF({ orientation:"portrait", unit:"mm", format:"a4" });
  const W = 210;
  const sc = SUPPLIERS[supplier].color;
  const [sr,sg,sb] = hexRgb(sc);
  const today = new Date().toLocaleDateString("en-GB");
  const goLive = siteInfo.goLive ? new Date(siteInfo.goLive+"T00:00:00").toLocaleDateString("en-GB") : "-";
  const annItems = result.breakdown.filter(b => b.section === "Annual");
  const eqLines = [
    `${scanners} x ${SUPPLIERS[supplier].name} AI Scanner${scanners>1?"s":""}`,
    ...(weighPays>0 ? [`${weighPays} x Weigh & Pay Scale${weighPays>1?"s":""}`] : []),
    `${scanners} x Worldpay PED${scanners>1?"s":""}`,
    ...(t2eExisting !== null ? [t2eExisting ? "Existing T2E site" : "New T2E site"] : []),
  ];

  // Header bar
  doc.setFillColor(17,24,39);
  doc.rect(0,0,W,26,"F");
  doc.addImage(compassB64,"PNG",10,4,50,17);
  doc.setTextColor(156,163,175);
  doc.setFontSize(7.5);
  doc.setFont("helvetica","normal");
  doc.text("Omni-Channel Digital Cost Summary", W-11,15,{align:"right"});

  // Colour band
  doc.setFillColor(sr,sg,sb);
  doc.rect(0,26,W,11,"F");
  doc.setTextColor(255,255,255);
  doc.setFontSize(12.5);
  doc.setFont("helvetica","bold");
  doc.text("Omni-Channel Digital Cost",11,34);

  // Info grid
  let y = 44;
  doc.setDrawColor(229,231,235);
  doc.setLineWidth(0.25);
  doc.roundedRect(10,y,W-20,40,2,2,"D");

  const infoCell = (label, value, x, cy) => {
    doc.setFontSize(7); doc.setFont("helvetica","bold"); doc.setTextColor(sr,sg,sb);
    doc.text(label.toUpperCase(), x, cy);
    doc.setFontSize(9.5); doc.setFont("helvetica","normal"); doc.setTextColor(17,24,39);
    doc.text(value||"-", x, cy+5);
  };
  infoCell("Site Name",    siteInfo.siteName,   13, y+8);
  infoCell("Unit Number",  siteInfo.unitNumber,  13, y+19);
  infoCell("Address",      siteInfo.address,     13, y+30);
  infoCell("Contact",      siteInfo.contactName, 13, y+37);  // bottom-left last line

  // Vertical divider
  doc.setDrawColor(229,231,235);
  doc.line(W/2, y+2, W/2, y+38);

  infoCell("Supplier",     SUPPLIERS[supplier].name,  W/2+4, y+8);
  infoCell("Status",       "Estimate - pre survey",    W/2+4, y+19);
  infoCell("Prepared by",  siteInfo.contactName,       W/2+4, y+30);
  infoCell("Target Go-Live", goLive,                   W/2+4, y+37);

  // Horizontal dividers inside box
  [y+13, y+24].forEach(ly => {
    doc.setDrawColor(243,244,246); doc.line(12,ly,W-12,ly);
  });

  y += 46;

  // Capital Cost section
  const drawSection = (title, rightLabel, items, subtotal) => {
    doc.setFillColor(sr,sg,sb);
    doc.rect(10,y,W-20,9,"F");
    doc.setTextColor(255,255,255); doc.setFont("helvetica","bold"); doc.setFontSize(10);
    doc.text(title,13,y+6);
    if (rightLabel) doc.text(rightLabel, W-12, y+6, {align:"right"});
    y += 11;
    items.forEach((item, i) => {
      if (i%2===0) { doc.setFillColor(249,250,251); doc.rect(10,y-1,W-20,8,"F"); }
      doc.setTextColor(55,65,81); doc.setFont("helvetica","normal"); doc.setFontSize(9);
      doc.text(item.label, 14, y+4.5);
      doc.text(fmtN(item.cost), W-13, y+4.5, {align:"right"});
      y += 8;
    });
    doc.setFillColor(229,231,235); doc.rect(10,y,W-20,8,"F");
    doc.setTextColor(17,24,39); doc.setFont("helvetica","bold"); doc.setFontSize(9.5);
    doc.text("Sub Total", 14, y+5.5);
    doc.text(fmt(subtotal), W-13, y+5.5, {align:"right"});
    y += 12;
  };

  drawSection("Capital Cost", "£", [
    {label:"Equipment & Configuration", cost:result.hardwareCost},
    {label:"Installation & Delivery",   cost:result.installCost},
    {label:"Implementation",            cost:result.implementationTotal},
  ], result.capitalCost);

  drawSection("Operating Cost - Per Annum", "£  Yr 1", annItems, result.annualCost);

  // Totals box
  doc.setDrawColor(229,231,235); doc.setLineWidth(0.25);
  doc.roundedRect(10,y,W-20,18,2,2,"D");
  doc.setTextColor(107,114,128); doc.setFont("helvetica","normal"); doc.setFontSize(9);
  doc.text("Sub Total",  14, y+7);
  doc.text(fmtN(result.capitalCost+result.annualCost), W-13, y+7, {align:"right"});
  doc.text("Contingency", 14, y+14);
  doc.text(fmtN(result.contingency), W-13, y+14, {align:"right"});
  y += 21;

  // Grand total
  doc.setFillColor(sr,sg,sb);
  doc.rect(10,y,W-20,11,"F");
  doc.setTextColor(255,255,255); doc.setFont("helvetica","bold"); doc.setFontSize(11.5);
  doc.text("Project Cost", 14, y+7.5);
  doc.text(fmt(result.grandTotal), W-13, y+7.5, {align:"right"});
  y += 16;

  // Equipment summary
  doc.setFont("helvetica","bold"); doc.setFontSize(10); doc.setTextColor(17,24,39);
  doc.text("Equipment Summary", 12, y+5);
  y += 9;
  doc.setFont("helvetica","normal"); doc.setFontSize(9); doc.setTextColor(55,65,81);
  eqLines.forEach(line => { doc.text("\u2022  " + line, 14, y); y += 6; });

  // Notice box
  y += 4;
  doc.setFillColor(255,251,235);
  doc.setDrawColor(252,211,77);
  doc.roundedRect(10,y,W-20,26,2,2,"FD");
  doc.setFontSize(7.5); doc.setFont("helvetica","bold"); doc.setTextColor(146,64,14);
  doc.text("IMPORTANT NOTICE", 14, y+6);
  doc.setFont("helvetica","normal"); doc.setTextColor(120,53,15); doc.setFontSize(7.5);
  const notice = "This costing is a close working guide subject to site surveys before a final cost can be confirmed.\nExclusions: Data points c.\u00a350/loc \u00b7 Power supply c.\u00a350/loc \u00b7 Menu build & marketing c.\u00a31,000-2,500 \u00b7 Strip & fit out c.\u00a3500-1,500/POS location.\nAll prices exc. VAT. Annual support costs subject to increase in line with the RPI index.";
  const lines = doc.splitTextToSize(notice, W-30);
  doc.text(lines, 14, y+12);

  // Footer
  doc.setFillColor(17,24,39);
  doc.rect(0,285,W,12,"F");
  doc.setTextColor(107,114,128); doc.setFontSize(7); doc.setFont("helvetica","normal");
  doc.text("Compass UK&I Digital  |  Leadership through innovation", 11, 292);
  doc.text("Generated "+today+" \u00b7 Estimate - subject to site survey", W-11, 292, {align:"right"});

  doc.save((siteInfo.siteName||"Quote").replace(/[^a-zA-Z0-9]/g,"_")+"_Summary.pdf");
}

function makeBreakdownPDF({ siteInfo, supplier, result, scanners, weighPays, t2eExisting }) {
  const doc = new jsPDF({ orientation:"landscape", unit:"mm", format:"a4" });
  const W = 297, H = 210;
  const sc = SUPPLIERS[supplier].color;
  const [sr,sg,sb] = hexRgb(sc);
  const today = new Date().toLocaleDateString("en-GB");
  const goLive = siteInfo.goLive ? new Date(siteInfo.goLive+"T00:00:00").toLocaleDateString("en-GB") : "-";

  // Header
  doc.setFillColor(17,24,39);
  doc.rect(0,0,W,22,"F");
  doc.addImage(compassB64,"PNG",8,3,44,15);
  doc.setTextColor(156,163,175); doc.setFontSize(7.5); doc.setFont("helvetica","normal");
  doc.text(`Detailed Cost Breakdown  |  ${SUPPLIERS[supplier].name}  |  ${siteInfo.siteName||"Quote"}`, W-10,13,{align:"right"});

  // Band
  doc.setFillColor(sr,sg,sb);
  doc.rect(0,22,W,9,"F");
  doc.setTextColor(255,255,255); doc.setFontSize(11); doc.setFont("helvetica","bold");
  doc.text(`Detailed Cost Breakdown \u2014 ${SUPPLIERS[supplier].name}`, 10, 28.5);
  doc.setFontSize(8); doc.setFont("helvetica","normal");
  doc.text(today, W-10, 28.5, {align:"right"});

  // Meta row
  let y = 34;
  doc.setFontSize(8); doc.setFont("helvetica","normal"); doc.setTextColor(55,65,81);
  const meta = [
    ["Site", siteInfo.siteName],["Unit", siteInfo.unitNumber],
    ["Address", siteInfo.address],["Contact", siteInfo.contactName],
    ["Go-Live", goLive],["Status","Estimate - pre survey"]
  ];
  let mx = 10;
  meta.forEach(([lbl,val]) => {
    doc.setFont("helvetica","bold"); doc.setTextColor(sr,sg,sb); doc.setFontSize(7);
    doc.text(lbl+":", mx, y+3);
    doc.setFont("helvetica","normal"); doc.setTextColor(55,65,81); doc.setFontSize(8);
    doc.text(val||"-", mx, y+8);
    mx += 46;
  });
  y += 13;

  // Table header
  const cols = [
    {label:"Description",  x:10,  w:106, align:"left"},
    {label:"Unit Cost",    x:118, w:28,  align:"right"},
    {label:"Qty",          x:148, w:16,  align:"center"},
    {label:"Total",        x:166, w:32,  align:"right"},
    {label:"Section",      x:200, w:34,  align:"left"},
    {label:"Annual (Yr 1)",x:236, w:34,  align:"right"},
  ];

  doc.setFillColor(55,65,81);
  doc.rect(10,y,W-20,8,"F");
  doc.setTextColor(255,255,255); doc.setFont("helvetica","bold"); doc.setFontSize(7.5);
  cols.forEach(c => {
    const tx = c.align==="right" ? c.x+c.w-1 : c.align==="center" ? c.x+c.w/2 : c.x+2;
    doc.text(c.label, tx, y+5.5, {align: c.align==="center"?"center": c.align==="right"?"right":"left"});
  });
  y += 10;

  // Rows
  const secs = ["Hardware","Installation","Annual","Implementation"];
  secs.forEach(sec => {
    const items = result.breakdown.filter(b => b.section === sec);
    if (!items.length) return;

    // Section header row
    doc.setFillColor(sr,sg,sb);
    doc.rect(10,y-1,W-20,7,"F");
    doc.setTextColor(255,255,255); doc.setFont("helvetica","bold"); doc.setFontSize(8);
    doc.text(sec.toUpperCase(), 13, y+4);
    y += 8;

    items.forEach((item, i) => {
      if (y > H-42) { doc.addPage(); y = 15; }
      if (i%2===0) { doc.setFillColor(249,250,251); doc.rect(10,y-1,W-20,7,"F"); }
      doc.setTextColor(55,65,81); doc.setFont("helvetica","normal"); doc.setFontSize(8.5);
      const labelText = item.label + (item.qty > 1 ? ` (x${item.qty})` : "");
      doc.text(labelText, 12, y+4);
      doc.text("\u00a3"+fmtN(item.unitCost), 145, y+4, {align:"right"});
      doc.text(String(item.qty), 156, y+4, {align:"center"});
      doc.setFont("helvetica","bold");
      doc.text("\u00a3"+fmtN(item.cost), 197, y+4, {align:"right"});
      doc.setFont("helvetica","normal");
      doc.text(sec, 202, y+4);
      doc.text(sec==="Annual" ? "\u00a3"+fmtN(item.cost) : "-", W-11, y+4, {align:"right"});
      y += 7;
    });

    // Subtotal
    const sub = items.reduce((a,b)=>a+b.cost,0);
    doc.setFillColor(229,231,235);
    doc.rect(10,y-1,W-20,7,"F");
    doc.setFont("helvetica","bold"); doc.setTextColor(17,24,39); doc.setFontSize(8.5);
    doc.text("Subtotal \u2014 "+sec, 13, y+4);
    doc.text("\u00a3"+fmtN(sub), 197, y+4, {align:"right"});
    if (sec==="Annual") doc.text("\u00a3"+fmtN(sub), W-11, y+4, {align:"right"});
    y += 10;
  });

  // Grand total block
  if (y > H-42) { doc.addPage(); y = 15; }
  doc.setDrawColor(229,231,235); doc.setLineWidth(0.25);
  doc.roundedRect(10,y,130,30,2,2,"D");
  doc.setFont("helvetica","normal"); doc.setFontSize(8.5); doc.setTextColor(107,114,128);
  const tots = [["Hardware",result.hardwareCost],["Installation",result.installCost],["Implementation",result.implementationTotal],["Annual / Ongoing",result.annualCost]];
  tots.forEach(([lbl,val],i) => {
    doc.text(lbl, 14, y+8+i*6);
    doc.text("\u00a3"+fmtN(val), 138, y+8+i*6, {align:"right"});
  });

  doc.roundedRect(148,y,W-158,30,2,2,"D");
  doc.text("Contingency", 152, y+8);
  doc.text("\u00a3"+fmtN(result.contingency), W-12, y+8, {align:"right"});
  doc.text("Sub Total", 152, y+16);
  doc.text("\u00a3"+fmtN(result.capitalCost+result.annualCost), W-12, y+16, {align:"right"});

  y += 33;
  doc.setFillColor(sr,sg,sb);
  doc.rect(10,y,W-20,11,"F");
  doc.setTextColor(255,255,255); doc.setFont("helvetica","bold"); doc.setFontSize(12);
  doc.text("TOTAL PROJECT COST", 14, y+7.5);
  doc.text(fmt(result.grandTotal), W-13, y+7.5, {align:"right"});

  // Footer
  doc.setFillColor(17,24,39);
  doc.rect(0,H-11,W,11,"F");
  doc.setTextColor(107,114,128); doc.setFontSize(6.5); doc.setFont("helvetica","normal");
  doc.text("Compass UK&I Digital  |  This costing is subject to site survey before a final cost is confirmed. All prices exc. VAT. Annual costs subject to RPI.", W/2, H-4.5, {align:"center"});

  doc.save((siteInfo.siteName||"Quote").replace(/[^a-zA-Z0-9]/g,"_")+"_Breakdown.pdf");
}

// ── Animated number ──────────────────────────────────────────────────────────
function AnimatedNumber({value}) {
  const [d,setD]=useState(0); const p=useRef(0);
  useEffect(()=>{
    const s=p.current,e=value,t0=performance.now();
    const f=(now)=>{const r=Math.min((now-t0)/700,1),ease=1-Math.pow(1-r,3);setD(s+(e-s)*ease);if(r<1)requestAnimationFrame(f);else{p.current=e;setD(e);}};
    requestAnimationFrame(f);
  },[value]);
  return <span>{fmt(d)}</span>;
}

// ── Main app ─────────────────────────────────────────────────────────────────
export default function App() {
  const [supplier,setSupplier]=useState(null);
  const [t2eExisting,setT2eExisting]=useState(null);
  const [scanners,setScanners]=useState(1);
  const [weighPays,setWeighPays]=useState(0);
  const [smeDays,setSmeDays]=useState(1);
  const [step,setStep]=useState("supplier");
  const [animIn,setAnimIn]=useState(true);
  const [siteName,setSiteName]=useState("");
  const [unitNumber,setUnitNumber]=useState("");
  const [contactName,setContactName]=useState("");
  const [address,setAddress]=useState("");
  const [goLive,setGoLive]=useState("");
  const [sector,setSector]=useState("");
  const [sectorContact,setSectorContact]=useState("");
  const [emailStatus,setEmailStatus]=useState("idle"); // idle | sending | sent | error
  const [emailError,setEmailError]=useState("");

  const steps=getSteps(supplier);
  const si=steps.indexOf(step);
  const sc=supplier?SUPPLIERS[supplier].color:"#1a56db";
  const nav=(next)=>{setAnimIn(false);setTimeout(()=>{setStep(next);setAnimIn(true);},180);};
  const goNext=()=>nav(steps[si+1]);
  const goBack=()=>nav(steps[si-1]);
  const reset=()=>{setAnimIn(false);setTimeout(()=>{setSupplier(null);setT2eExisting(null);setScanners(1);setWeighPays(0);setSmeDays(1);setSiteName("");setUnitNumber("");setContactName("");setAddress("");setGoLive("");setSector("");setSectorContact("");setEmailStatus("idle");setEmailError("");setStep("supplier");setAnimIn(true);},180);};

  const result=step==="summary"?calcQuote({supplier,scanners,weighPays,smeDays,t2eExisting}):null;
  const siteInfo={siteName,unitNumber,contactName,address,goLive,sector,sectorContact};
  const pdfArgs={siteInfo,supplier,result,scanners,weighPays,t2eExisting};

  const sendPipelineEmail=()=>{
    setEmailStatus("sending");
    const todayStr=new Date().toLocaleDateString("en-GB");
    const goLiveStr=goLive?new Date(goLive+"T00:00:00").toLocaleDateString("en-GB"):"-";
    const quote=calcQuote({supplier,scanners,weighPays,smeDays,t2eExisting});
    const params={
      client_name:        siteName,
      name:               siteName,
      outlet_name:        siteName,
      solution:           SUPPLIERS[supplier].name,
      total_cost:         fmt(quote.grandTotal),
      capital_cost:       fmt(quote.capitalCost),
      annual_cost:        fmt(quote.annualCost),
      date:               todayStr,
      date_initial_request: todayStr,
      go_live_date:       goLiveStr,
      unit_number:        unitNumber||"-",
      address:            address||"-",
      contact_name:       contactName||"-",
      sector:             sector,
      sector_contact:     sectorContact,
      status:             "Prospect",
      ai_tray_autocanteen:    supplier==="AUTOCANTEEN"?String(scanners):"",
      ai_tray_vision_checkout:supplier==="VISION_CHECKOUT"?String(scanners):"",
      deligo_ai_scanners:     supplier==="DELIGO"?String(scanners):"",
    };
    emailjs.send(EMAILJS_SERVICE_ID,EMAILJS_TEMPLATE_ID,params,EMAILJS_PUBLIC_KEY)
      .then(()=>setEmailStatus("sent"))
      .catch((err)=>{console.error("EmailJS error:",err);setEmailError(err?.text||err?.message||String(err));setEmailStatus("error");});
  };

  const css=`
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Playfair+Display:wght@600&display=swap');
    *{box-sizing:border-box;margin:0;padding:0;}
    body{background:linear-gradient(135deg,#eef2ff 0%,#f9fafb 50%,#f0fdf4 100%);min-height:100vh;}
    .wrap{width:100%;max-width:760px;font-family:'Inter',sans-serif;}
    .hdr{display:flex;align-items:center;justify-content:space-between;padding:1rem 1.5rem;background:#111827;border-radius:14px;margin-bottom:1.75rem;box-shadow:0 4px 20px rgba(0,0,0,.2);}
    .hdr-logo{height:36px;object-fit:contain;}
    .hdr-lbl{color:#9ca3af;font-size:.68rem;letter-spacing:.18em;text-transform:uppercase;font-weight:500;}
    .hdr-sup{height:24px;object-fit:contain;border-radius:4px;background:#fff;padding:2px 6px;}
    .prog-track{height:4px;background:#e5e7eb;border-radius:4px;overflow:hidden;margin-bottom:.45rem;}
    .prog-fill{height:100%;border-radius:4px;transition:width .5s cubic-bezier(.4,0,.2,1);}
    .prog-lbl{font-size:.66rem;color:#9ca3af;font-weight:500;letter-spacing:.05em;text-transform:uppercase;margin-bottom:1.6rem;}
    .page-in{animation:sIn .22s cubic-bezier(.4,0,.2,1) both;}
    .page-out{animation:sOut .18s cubic-bezier(.4,0,.2,1) both;}
    @keyframes sIn{from{opacity:0;transform:translateY(12px)}to{opacity:1;transform:translateY(0)}}
    @keyframes sOut{from{opacity:1;transform:translateY(0)}to{opacity:0;transform:translateY(-8px)}}
    .ttl{font-family:'Playfair Display',serif;font-size:2rem;color:#111827;line-height:1.15;margin-bottom:.3rem;}
    .sub{font-size:.7rem;color:#9ca3af;letter-spacing:.1em;text-transform:uppercase;font-weight:500;margin-bottom:1.6rem;}
    .card{background:#fff;border:1px solid #e5e7eb;border-radius:14px;padding:1.6rem 1.85rem;margin-bottom:1rem;box-shadow:0 2px 10px rgba(0,0,0,.05);}
    .sec-lbl{font-size:.6rem;letter-spacing:.25em;text-transform:uppercase;color:#9ca3af;font-weight:600;margin-bottom:1rem;}
    .sup-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:.8rem;}
    .sup-card{border:2px solid #e5e7eb;border-radius:12px;padding:1.4rem .7rem;cursor:pointer;text-align:center;transition:all .2s cubic-bezier(.4,0,.2,1);background:#fafafa;display:flex;flex-direction:column;align-items:center;gap:.7rem;}
    .sup-card:hover{border-color:#d1d5db;background:#fff;box-shadow:0 4px 14px rgba(0,0,0,.09);transform:translateY(-2px);}
    .sup-card.active{background:#fff;box-shadow:0 4px 18px rgba(0,0,0,.12);transform:translateY(-2px);}
    .sup-logo{height:40px;object-fit:contain;max-width:120px;}
    .sup-chk{width:20px;height:20px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:.65rem;color:#fff;font-weight:700;transition:all .2s;}
    .qty-row{display:flex;align-items:center;justify-content:space-between;padding:.85rem 0;border-bottom:1px solid #f3f4f6;}
    .qty-row:last-child{border-bottom:none;padding-bottom:0;}
    .qty-row:first-child{padding-top:0;}
    .qty-lbl{font-size:.92rem;color:#111827;font-weight:500;}
    .qty-lbl small{display:block;font-size:.68rem;color:#9ca3af;margin-top:.12rem;font-weight:400;}
    .qty-ctrl{display:flex;align-items:center;gap:.65rem;}
    .qty-btn{width:32px;height:32px;border:1.5px solid #e5e7eb;background:#f9fafb;color:#374151;font-size:1rem;cursor:pointer;border-radius:8px;display:flex;align-items:center;justify-content:center;transition:all .15s;font-weight:600;}
    .qty-btn:hover:not(:disabled){background:#f3f4f6;border-color:#d1d5db;}
    .qty-btn:disabled{opacity:.3;cursor:default;}
    .qty-val{font-size:1.3rem;min-width:2rem;text-align:center;font-weight:700;}
    .t2e-grid{display:grid;grid-template-columns:1fr 1fr;gap:.8rem;}
    .t2e-card{border:2px solid #e5e7eb;border-radius:12px;padding:1.4rem 1.1rem;cursor:pointer;text-align:center;transition:all .2s;background:#fafafa;}
    .t2e-card:hover{background:#fff;border-color:#d1d5db;transform:translateY(-1px);box-shadow:0 4px 12px rgba(0,0,0,.07);}
    .t2e-ttl{font-size:1.1rem;font-weight:700;margin-bottom:.3rem;color:#111827;}
    .t2e-desc{font-size:.7rem;color:#6b7280;line-height:1.5;}
    .btn-row{display:flex;align-items:center;gap:.65rem;margin-top:.25rem;}
    .btn-p{padding:.75rem 1.85rem;border:none;border-radius:9px;font-family:'Inter',sans-serif;font-size:.86rem;font-weight:600;cursor:pointer;transition:all .2s;box-shadow:0 2px 8px rgba(0,0,0,.12);}
    .btn-p:hover:not(:disabled){transform:translateY(-1px);box-shadow:0 4px 14px rgba(0,0,0,.18);}
    .btn-p:disabled{opacity:.4;cursor:default;transform:none;box-shadow:none;}
    .btn-g{padding:.75rem 1.4rem;border:1.5px solid #e5e7eb;border-radius:9px;font-family:'Inter',sans-serif;font-size:.8rem;cursor:pointer;background:#fff;color:#6b7280;transition:all .15s;font-weight:500;}
    .btn-g:hover{border-color:#d1d5db;color:#374151;background:#f9fafb;}
    .badge{display:inline-flex;align-items:center;gap:.45rem;padding:.28rem .85rem;border-radius:100px;font-size:.66rem;letter-spacing:.08em;margin-bottom:1.4rem;font-weight:600;}
    .badge img{height:15px;object-fit:contain;}
    .bk-sec{margin-bottom:1.25rem;}
    .bk-title{font-size:.58rem;letter-spacing:.25em;text-transform:uppercase;color:#9ca3af;padding-bottom:.4rem;border-bottom:1.5px solid #f3f4f6;margin-bottom:.6rem;font-weight:600;}
    .bk-row{display:flex;justify-content:space-between;align-items:center;padding:.28rem 0;font-size:.84rem;}
    .bk-row .bl{color:#6b7280;} .bk-row .ba{font-weight:600;color:#111827;}
    .totals{background:#f9fafb;border:1.5px solid #e5e7eb;border-radius:12px;padding:1.25rem 1.6rem;margin-top:1rem;}
    .t-row{display:flex;justify-content:space-between;align-items:center;margin-bottom:.4rem;font-size:.86rem;}
    .t-row .tl{color:#6b7280;} .t-row .ta{font-weight:600;color:#111827;}
    .t-div{border:none;border-top:1.5px solid #e5e7eb;margin:.8rem 0;}
    .t-row.big{font-size:1.05rem;}
    .t-row.big .tl{font-weight:600;color:#111827;}
    .t-row.big .ta{font-size:1.2rem;font-weight:700;}
    .sme-info{font-size:.68rem;color:#9ca3af;margin-top:.6rem;line-height:1.6;}
    .disc{font-size:.65rem;color:#9ca3af;margin-top:1.4rem;line-height:1.7;}
    .wm{position:fixed;bottom:1.5rem;right:1.5rem;opacity:.07;width:110px;pointer-events:none;}
    .fg{display:grid;grid-template-columns:1fr 1fr;gap:.9rem;}
    .fgrp{display:flex;flex-direction:column;gap:.32rem;}
    .fgrp.full{grid-column:1/-1;}
    .flbl{font-size:.7rem;font-weight:600;color:#374151;letter-spacing:.04em;}
    .finp{padding:.6rem .85rem;border:1.5px solid #e5e7eb;border-radius:8px;font-family:'Inter',sans-serif;font-size:.86rem;color:#111827;background:#fff;transition:border-color .15s;outline:none;}
    .finp:focus{border-color:var(--sc,#1a56db);box-shadow:0 0 0 3px rgba(26,86,219,.08);}
    .pdf-panel{background:#fff;border-radius:14px;border:1.5px solid #e5e7eb;padding:1.4rem 1.85rem;margin-top:1.6rem;box-shadow:0 2px 10px rgba(0,0,0,.05);}
    .pdf-desc{font-size:.8rem;color:#6b7280;margin-bottom:1.1rem;line-height:1.6;}
    .pdf-btns{display:flex;gap:.75rem;flex-wrap:wrap;}
    .pdf-btn{display:flex;align-items:center;gap:.5rem;padding:.85rem 1.6rem;border:none;border-radius:10px;font-family:'Inter',sans-serif;font-size:.88rem;font-weight:600;cursor:pointer;transition:all .2s;box-shadow:0 2px 12px rgba(0,0,0,.14);}
    .pdf-btn:hover{transform:translateY(-2px);box-shadow:0 5px 20px rgba(0,0,0,.2);}
    .pdf-btn:active{transform:translateY(0);}
    .fsel{appearance:none;background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%236b7280' d='M6 8L1 3h10z'/%3E%3C/svg%3E");background-repeat:no-repeat;background-position:right .7rem center;padding-right:2rem;cursor:pointer;}
    .pipeline-section{margin-top:1.25rem;padding-top:1.25rem;border-top:1.5px solid #e5e7eb;}
    .pipeline-lbl{font-size:.6rem;letter-spacing:.25em;text-transform:uppercase;color:#9ca3af;font-weight:600;margin-bottom:.4rem;}
    .pipeline-desc{font-size:.78rem;color:#6b7280;margin-bottom:.85rem;line-height:1.5;}
    .pipeline-btn{background:#059669 !important;color:#fff !important;}
    .pipeline-btn:disabled{opacity:.55;cursor:default;transform:none !important;box-shadow:0 2px 12px rgba(0,0,0,.14) !important;}
    .pipeline-ok{font-size:.84rem;font-weight:600;color:#059669;padding:.65rem 1rem;background:#ecfdf5;border:1.5px solid #6ee7b7;border-radius:9px;display:inline-flex;align-items:center;gap:.45rem;}
    .pipeline-err{font-size:.78rem;color:#b91c1c;margin-top:.6rem;padding:.55rem .9rem;background:#fef2f2;border:1.5px solid #fca5a5;border-radius:8px;}
  `;

  return (
    <div style={{minHeight:"100vh",display:"flex",flexDirection:"column",alignItems:"center",padding:"2rem 1rem","--sc":sc}}>
      <style>{css}</style>
      <img src={compassB64} className="wm" alt=""/>
      <div className="wrap">
        <div className="hdr">
          <img src={compassB64} className="hdr-logo" alt="Compass UK&I Digital"/>
          <span className="hdr-lbl">Quote Generator</span>
          {supplier && <img src={SUPPLIERS[supplier].logo} className="hdr-sup" alt={SUPPLIERS[supplier].name}/>}
        </div>
        <div className="prog-track">
          <div className="prog-fill" style={{width:((si+1)/steps.length*100)+"%",background:sc}}/>
        </div>
        <div className="prog-lbl">Step {si+1} of {steps.length}</div>
        <div className={animIn?"page-in":"page-out"}>

          {step==="supplier"&&(<>
            <div className="ttl">Select a supplier</div>
            <div className="sub">to begin your quote</div>
            <div className="card">
              <div className="sec-lbl">Available suppliers</div>
              <div className="sup-grid">
                {Object.entries(SUPPLIERS).map(([k,s])=>(
                  <div key={k} className={"sup-card"+(supplier===k?" active":"")} style={{borderColor:supplier===k?s.color:undefined}} onClick={()=>setSupplier(k)}>
                    <img src={s.logo} className="sup-logo" alt={s.name}/>
                    <div className="sup-chk" style={{background:supplier===k?s.color:"#e5e7eb"}}>{supplier===k?"✓":""}</div>
                  </div>
                ))}
              </div>
            </div>
            <div className="btn-row"><button className="btn-p" disabled={!supplier} style={{background:supplier?sc:"#e5e7eb",color:supplier?"#fff":"#9ca3af"}} onClick={()=>nav(getSteps(supplier)[1])}>Continue →</button></div>
          </>)}

          {step==="t2e"&&(<>
            <div className="ttl">Is the site already on T2E?</div>
            <div className="sub">Deligo · T2E status</div>
            <div className="badge" style={{background:sc+"18",color:sc}}><img src={SUPPLIERS[supplier].logo} alt=""/>Deligo</div>
            <div className="card">
              <div className="sec-lbl">T2E system status</div>
              <div className="t2e-grid">
                {[{v:true,l:"Yes",d:"Site already uses T2E — no Control Desk fee"},{v:false,l:"No",d:"New to T2E — £625 p/a Control Desk fee applies"}].map(o=>(
                  <div key={String(o.v)} className="t2e-card" style={{borderColor:t2eExisting===o.v?sc:undefined,background:t2eExisting===o.v?sc+"0d":undefined}} onClick={()=>setT2eExisting(o.v)}>
                    <div className="t2e-ttl" style={{color:t2eExisting===o.v?sc:"#111827"}}>{o.l}</div>
                    <div className="t2e-desc">{o.d}</div>
                  </div>
                ))}
              </div>
            </div>
            <div className="btn-row"><button className="btn-g" onClick={goBack}>← Back</button><button className="btn-p" disabled={t2eExisting===null} style={{background:t2eExisting!==null?sc:"#e5e7eb",color:t2eExisting!==null?"#fff":"#9ca3af"}} onClick={goNext}>Continue →</button></div>
          </>)}

          {step==="quantities"&&supplier&&(<>
            <div className="ttl">Configure your order</div>
            <div className="sub">{SUPPLIERS[supplier].name} · Quantities</div>
            <div className="badge" style={{background:sc+"18",color:sc}}><img src={SUPPLIERS[supplier].logo} alt=""/>{SUPPLIERS[supplier].name}</div>
            <div className="card">
              <div className="sec-lbl">Unit quantities</div>
              {[
                {val:scanners,set:setScanners,min:1,lbl:"AI Scanners",sub:supplier==="VISION_CHECKOUT"?"AI Scanner & Base incl. Receipt Printer":supplier==="AUTOCANTEEN"?"AI Scanner & Receipt Printer":"AI Scanner"},
                {val:weighPays,set:setWeighPays,min:0,lbl:"Weigh & Pay Scales",sub:"£"+(supplier==="VISION_CHECKOUT"?"750":supplier==="AUTOCANTEEN"?"660":"695")+" per unit"},
              ].map((r,i)=>(<div className="qty-row" key={i}><div className="qty-lbl">{r.lbl}<small>{r.sub}</small></div><div className="qty-ctrl"><button className="qty-btn" disabled={r.val<=r.min} onClick={()=>r.set(Math.max(r.min,r.val-1))}>−</button><span className="qty-val" style={{color:sc}}>{r.val}</span><button className="qty-btn" onClick={()=>r.set(r.val+1)}>+</button></div></div>))}
            </div>
            <div className="btn-row"><button className="btn-g" onClick={goBack}>← Back</button><button className="btn-p" style={{background:sc,color:"#fff"}} onClick={goNext}>Continue →</button></div>
          </>)}

          {step==="sme"&&(<>
            <div className="ttl">Implementation days</div>
            <div className="sub">{SUPPLIERS[supplier].name} · SME days</div>
            <div className="badge" style={{background:sc+"18",color:sc}}><img src={SUPPLIERS[supplier].logo} alt=""/>{SUPPLIERS[supplier].name}</div>
            <div className="card">
              <div className="sec-lbl">Subject Matter Expert days</div>
              <div className="qty-row" style={{borderBottom:"none",paddingBottom:0}}>
                <div className="qty-lbl">SME Days<small>Number of days on-site required</small></div>
                <div className="qty-ctrl"><button className="qty-btn" disabled={smeDays<=1} onClick={()=>setSmeDays(Math.max(1,smeDays-1))}>−</button><span className="qty-val" style={{color:sc}}>{smeDays}</span><button className="qty-btn" onClick={()=>setSmeDays(smeDays+1)}>+</button></div>
              </div>
              <div className="sme-info">Minimum 1 SME day required.</div>
            </div>
            <div className="btn-row"><button className="btn-g" onClick={goBack}>← Back</button><button className="btn-p" style={{background:sc,color:"#fff"}} onClick={goNext}>Continue →</button></div>
          </>)}

          {step==="siteinfo"&&(<>
            <div className="ttl">Site information</div>
            <div className="sub">Details for the quote documents</div>
            <div className="badge" style={{background:sc+"18",color:sc}}><img src={SUPPLIERS[supplier].logo} alt=""/>{SUPPLIERS[supplier].name}</div>
            <div className="card">
              <div className="sec-lbl">Site & contact details</div>
              <div className="fg">
                <div className="fgrp"><label className="flbl">Site / Outlet Name *</label><input className="finp" style={{"--sc":sc}} value={siteName} onChange={e=>setSiteName(e.target.value)} placeholder="e.g. Bank of Canada"/></div>
                <div className="fgrp"><label className="flbl">Unit Number</label><input className="finp" value={unitNumber} onChange={e=>setUnitNumber(e.target.value)} placeholder="e.g. U001"/></div>
                <div className="fgrp"><label className="flbl">Target Go-Live Date *</label><input className="finp" type="date" value={goLive} onChange={e=>setGoLive(e.target.value)} style={{"--sc":sc}}/></div>
                <div className="fgrp full"><label className="flbl">Unit Address</label><input className="finp" value={address} onChange={e=>setAddress(e.target.value)} placeholder="e.g. 40 King William Street, London, EC4R 9AT"/></div>
                <div className="fgrp"><label className="flbl">Sector *</label><select className="finp fsel" style={{"--sc":sc}} value={sector} onChange={e=>setSector(e.target.value)}><option value="">— Select sector —</option>{SECTORS.map(s=><option key={s} value={s}>{s}</option>)}</select></div>
                <div className="fgrp"><label className="flbl">Sector Contact *</label><input className="finp" value={sectorContact} onChange={e=>setSectorContact(e.target.value)} placeholder="e.g. Jane Smith"/></div>
              </div>
            </div>
            <div className="btn-row"><button className="btn-g" onClick={goBack}>← Back</button><button className="btn-p" disabled={!siteName||!goLive||!sector||!sectorContact} style={{background:(siteName&&goLive&&sector&&sectorContact)?sc:"#e5e7eb",color:(siteName&&goLive&&sector&&sectorContact)?"#fff":"#9ca3af"}} onClick={goNext}>View Quote →</button></div>
          </>)}

          {step==="summary"&&result&&(<>
            <div className="ttl">Quote summary</div>
            <div className="sub">{siteName} · {SUPPLIERS[supplier].name}</div>
            <div className="badge" style={{background:sc+"18",color:sc}}>
              <img src={SUPPLIERS[supplier].logo} alt=""/>
              {scanners} scanner{scanners!==1?"s":""}{weighPays>0?` + ${weighPays} weigh & pay`:""} · {smeDays} SME day{smeDays!==1?"s":""}
            </div>
            <div className="card">
              {["Hardware","Installation","Annual","Implementation"].map(sec=>{
                const items=result.breakdown.filter(b=>b.section===sec);
                if(!items.length) return null;
                return(<div className="bk-sec" key={sec}><div className="bk-title">{sec}</div>{items.map((it,i)=>(<div className="bk-row" key={i}><span className="bl">{it.label}{it.qty>1?` (x${it.qty})`:""}</span><span className="ba">{fmt(it.cost)}</span></div>))}</div>);
              })}
            </div>
            <div className="totals">
              <div className="t-row"><span className="tl">Hardware</span><span className="ta">{fmt(result.hardwareCost)}</span></div>
              <div className="t-row"><span className="tl">Installation</span><span className="ta">{fmt(result.installCost)}</span></div>
              <div className="t-row"><span className="tl">Implementation</span><span className="ta">{fmt(result.implementationTotal)}</span></div>
              <hr className="t-div"/>
              <div className="t-row big"><span className="tl">Capital Cost</span><span className="ta" style={{color:sc}}><AnimatedNumber value={result.capitalCost}/></span></div>
              <hr className="t-div"/>
              <div className="t-row"><span className="tl">Annual / Ongoing Cost</span><span className="ta">{fmt(result.annualCost)}</span></div>
              <hr className="t-div"/>
              <div className="t-row"><span className="tl">Contingency</span><span className="ta">{fmt(result.contingency)}</span></div>
              <hr className="t-div"/>
              <div className="t-row big"><span className="tl">Total Project Cost</span><span className="ta" style={{color:sc}}><AnimatedNumber value={result.grandTotal}/></span></div>
            </div>
            <div className="pdf-panel">
              <div className="sec-lbl" style={{marginBottom:".5rem"}}>Generate Documents</div>
              <div className="pdf-desc">Click to instantly download a branded PDF to your device.</div>
              <div className="pdf-btns">
                <button className="pdf-btn" style={{background:sc,color:"#fff"}} onClick={()=>makeSummaryPDF(pdfArgs)}>
                  📄 Download Client Summary
                </button>
                <button className="pdf-btn" style={{background:"#374151",color:"#fff"}} onClick={()=>makeBreakdownPDF(pdfArgs)}>
                  📋 Download Cost Breakdown
                </button>
              </div>
              <div className="pipeline-section">
                <div className="pipeline-lbl">Submit to Pipeline</div>
                <div className="pipeline-desc">Send this opportunity to the Power Automate pipeline for tracking.</div>
                {emailStatus==="sent"?(
                  <div className="pipeline-ok">✓ Submitted successfully — pipeline notified.</div>
                ):(
                  <button className="pdf-btn pipeline-btn" disabled={emailStatus==="sending"} onClick={sendPipelineEmail}>
                    {emailStatus==="sending"?"⏳ Submitting…":"🚀 Submit to Pipeline"}
                  </button>
                )}
                {emailStatus==="error"&&<div className="pipeline-err">⚠ Submission failed{emailError?` — ${emailError}`:""}</div>}
              </div>
            </div>
            <div className="btn-row" style={{marginTop:"1.4rem"}}>
              <button className="btn-g" onClick={goBack}>← Adjust</button>
              <button className="btn-g" onClick={reset}>Start Over</button>
            </div>
            <div className="disc">* All figures exc. VAT. Annual costs indicative, billed per supplier agreement. Contingency applied to total project value.</div>
          </>)}

        </div>
      </div>
    </div>
  );
}
